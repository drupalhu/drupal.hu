langcode: 'en'
status: true
id: 'app_legacy__node__forum__rev'
label: 'App - Legacy - node:forum:revision'

migration_group: 'app_legacy'
migration_tags:
  - 'src_node'
  - 'src_node__forum'
  - 'dst_node'
  - 'dst_node__forum'
  - 'revision'

migration_dependencies:
  required:
    - 'app_legacy__user__user'
    - 'app_legacy__node__forum'
    - 'app_legacy__taxonomy_term:drupal_version'
    - 'app_legacy__taxonomy_term:forums'
    - 'app_legacy__taxonomy_term:project'

source:
  plugin: 'd7_node_revision'
  node_type: 'forum'
  constants:
    body_text_format: 'html_body'
    langcode: 'hu'
    default_langcode: true

process:
  langcode: 'constants/langcode'
  default_langcode: 'constants/default_langcode'
  nid: 'nid'
  vid: 'vid'
  uid:
    -
      source: 'node_uid'
      plugin: 'skip_on_empty'
      method: 'process'
    -
      plugin: 'migration_lookup'
      migration:
        - 'app_legacy__user__user'
  status: 'status'
  created: 'created'
  changed: 'changed'
  promote: 'promote'
  sticky: 'sticky'
  revision_uid:
    -
      source: 'revision_uid'
      plugin: 'skip_on_empty'
      method: 'process'
    -
      plugin: 'migration_lookup'
      migration:
        - 'app_legacy__user__user'
  revision_log: 'log'
  revision_timestamp: 'timestamp'

  title: 'title'

  app_body/0/value: 'body/0/value'
  app_body/0/format: 'constants/body_text_format'

  taxonomy_forums:
    source: 'taxonomy_forums'
    plugin: 'sub_process'
    process:
      target_id:
        source: 'tid'
        plugin: 'migration_lookup'
        migration:
          - 'app_legacy__taxonomy_term:forums'

  app_drupal_version:
    source: 'taxonomy_vocabulary_10'
    plugin: 'sub_process'
    process:
      target_id:
        source: 'tid'
        plugin: 'migration_lookup'
        migration:
          - 'app_legacy__taxonomy_term:drupal_version'

  app_project:
    source: 'taxonomy_vocabulary_11'
    plugin: 'sub_process'
    process:
      target_id:
        source: 'tid'
        plugin: 'migration_lookup'
        no_stub: true
        migration:
          - 'app_legacy__taxonomy_term:project'

destination:
  plugin: 'entity_revision:node'
  default_bundle: 'forum'
