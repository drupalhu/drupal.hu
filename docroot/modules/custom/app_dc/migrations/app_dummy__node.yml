langcode: 'en'
status: true
id: 'app_dummy__node'
label: 'App - Dummy - node'

migration_group: 'app_dummy'
migration_tags:
  - 'dst_node'

migration_dependencies:
  required:
    - 'app_dummy__file__public'
    - 'app_dummy__media__image'
    - 'app_default__taxonomy_term'
    - 'app_dummy__taxonomy_term'
    - 'app_dummy__user'

source:
  plugin: 'migrate_dc_yaml'
  fileDir: '../sites/default/content/app_dummy'
  fileName: 'node/all.yml'
  identifier: 'id'

  fields:
    id: 'Identifier'
    uuid: 'UUID'
    type: 'Type'
    langcode: 'Language code'
    uid: 'Author'
    status: 'Status'
    created: 'Created'
    changed: 'Changed'
    title: 'Title'
    app_attachments: 'Attachments'
    app_body: 'Body'
    app_comment_admin: 'Comment - admin'
    app_competence: 'Competence'
    app_date: 'Date'
    app_drupal_version: 'Drupal_version'
    app_image: 'Image'
    app_job_advantage: 'Job - advantage'
    app_job_announcer_gives: 'Job - announcer_gives'
    app_job_contact_email: 'Job - contact_email'
    app_job_contact_name: 'Job - contact_name'
    app_job_contact_org: 'Job - contact_org'
    app_job_contact_phone: 'Job - contact_phone'
    app_job_due_date: 'Job - due_date'
    app_job_employment: 'Job - employment'
    app_job_expectations: 'Job - expectations'
    app_job_language: 'Job - language'
    app_job_level: 'Job - level'
    app_job_location_name: 'Job - location_name'
    app_job_location_type: 'Job - location_type'
    app_links: 'Links'
    app_project: 'Project'
    app_target_audience: 'Target audience'
    app_teaser: 'Teaser'
    body: 'Body (core)'
    comment_forum: 'Comment - forum'
    taxonomy_forums: 'Forum'

process:
  uuid: 'uuid'
  type: 'type'
  langcode:
    source: 'langcode'
    plugin: 'default_value'
    default_value: 'hu'

  uid_lookup:
    -
      source: 'uid'
      plugin: 'migration_lookup'
      no_stub: true
      migration:
        - 'app_dummy__user'
  uid:
    -
      source: '@uid_lookup'
      plugin: 'default_value'
      default_value: 1

  status:
    source: 'status'
    plugin: 'default_value'
    default_value: true
    strict: true

  created:
    -
      source: 'created'
      plugin: 'default_value'
      default_value: 'now'
    -
      plugin: 'migrate_dc_str_to_time'

  changed:
    -
      source: 'changed'
      plugin: 'default_value'
      default_value: 'now'
    -
      plugin: 'migrate_dc_str_to_time'

  title: 'title'

  app_attachments:
    -
      source: 'app_attachments'
      plugin: 'skip_on_empty'
      method: 'process'
    -
      plugin: 'sub_process'
      process:
        target_id:
          source: 'target_id'
          plugin: 'migration_lookup'
          migration:
            - 'app_dummy__file__public'

  app_body:
    source: 'app_body'
    plugin: 'sub_process'
    process:
      value: 'value'
      format:
        source: 'format'
        plugin: 'default_value'
        default_value: 'html_body'

#  app_comment_admin:
#    -
#      source: 'app_comment_admin'

  app_drupal_version:
    -
      source: 'app_drupal_version'
      plugin: 'skip_on_empty'
      method: 'process'
    -
      plugin: 'sub_process'
      process:
        target_id:
          source: 'target_id'
          plugin: 'migration_lookup'
          migration:
            - 'app_default__taxonomy_term'
            - 'app_dummy__taxonomy_term'

  app_image:
    -
      source: 'app_image'
      plugin: 'skip_on_empty'
      method: 'process'
    -
      plugin: 'sub_process'
      process:
        target_id:
          source: 'target_id'
          plugin: 'migration_lookup'
          migration:
            - 'app_dummy__media__image'

  app_job_advantage:
    source: 'app_job_advantage'
    plugin: 'sub_process'
    process:
      value: 'value'
      format:
        source: 'format'
        plugin: 'default_value'
        default_value: 'html_body'

  app_job_announcer_gives:
    source: 'app_job_announcer_gives'
    plugin: 'sub_process'
    process:
      value: 'value'
      format:
        source: 'format'
        plugin: 'default_value'
        default_value: 'html_body'

  app_job_contact_email: 'app_job_contact_email'

  app_job_contact_name: 'app_job_contact_name'

  app_job_contact_phone: 'app_job_contact_phone'

  app_job_contact_org: 'app_job_contact_org'

  app_job_due_date:
    -
      source: 'app_job_due_date'
      plugin: 'skip_on_empty'
      method: 'process'
    -
      plugin: 'sub_process'
      process:
        value:
          source: 'value'
          plugin: 'migrate_dc_str_to_time'
          output_format: 'Y-m-d\TH:i:s'

  app_job_employment: 'app_job_employment'

  app_job_expectations:
    source: 'app_job_expectations'
    plugin: 'sub_process'
    process:
      value: 'value'
      format:
        source: 'format'
        plugin: 'default_value'
        default_value: 'html_body'

  app_job_language: 'app_job_language'

  app_job_level: 'app_job_level'

  app_job_location_name: 'app_job_location_name'

  app_job_location_type: 'app_job_location_type'

  app_tags:
    -
      source: 'app_tags'
      plugin: 'skip_on_empty'
      method: 'process'
    -
      plugin: 'sub_process'
      process:
        target_id:
          source: 'target_id'
          plugin: 'migration_lookup'
          migration:
            - 'app_dummy__taxonomy_term'

  app_project:
    -
      source: 'app_project'
      plugin: 'skip_on_empty'
      method: 'process'
    -
      plugin: 'sub_process'
      process:
        target_id:
          source: 'target_id'
          plugin: 'migration_lookup'
          migration:
            - 'app_default__taxonomy_term'
            - 'app_dummy__taxonomy_term'

  app_teaser:
    source: 'app_teaser'
    plugin: 'sub_process'
    process:
      value: 'value'
      format:
        source: 'format'
        plugin: 'default_value'
        default_value: 'html_teaser'

  taxonomy_forums:
    -
      source: 'taxonomy_forums'
      plugin: 'skip_on_empty'
      method: 'process'
    -
      plugin: 'sub_process'
      process:
        target_id:
          source: 'target_id'
          plugin: 'migration_lookup'
          migration:
            - 'app_default__taxonomy_term'
            - 'app_dummy__taxonomy_term'

destination:
  plugin: 'entity:node'
#  overwrite_properties:
#    - 'langcode'
#    - 'uid'
#    - 'status'
#    - 'created'
#    - 'changed'
#    - 'title'
#    - 'app_attachments'
#    - 'app_body'
#    - 'app_comment_admin'
#    - 'app_competence'
#    - 'app_date'
#    - 'app_drupal_version'
#    - 'app_image'
#    - 'app_job_advantage'
#    - 'app_job_announcer_gives'
#    - 'app_job_contact_email'
#    - 'app_job_contact_name'
#    - 'app_job_contact_org'
#    - 'app_job_contact_phone'
#    - 'app_job_due_date'
#    - 'app_job_employment'
#    - 'app_job_expectations'
#    - 'app_job_language'
#    - 'app_job_level'
#    - 'app_job_location_name'
#    - 'app_job_location_type'
#    - 'app_links'
#    - 'app_project'
#    - 'app_tags'
#    - 'app_target_audience'
#    - 'app_teaser'
#    - 'body'
#    - 'comment_forum'
#    - 'taxonomy_forums'
